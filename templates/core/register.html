{% extends 'core/base.html' %}

{% block title %}Cadastro - Locus{% endblock %}

{% block content %}
<h2>Cadastro</h2>
<form method="post" id="registerForm" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div>
        {{ form.first_name.label_tag }}
        {{ form.first_name }}
        {{ form.first_name.errors }}
    </div>
    <div>
        {{ form.last_name.label_tag }}
        {{ form.last_name }}
        {{ form.last_name.errors }}
    </div>
    <div>
        {{ form.username.label_tag }}
        {{ form.username }}
        {{ form.username.errors }}
    </div>
    <div>
        {{ form.email.label_tag }}
        {{ form.email }}
        {{ form.email.errors }}
    </div>
    <div>
        {{ form.password1.label_tag }}
        {{ form.password1 }}
        {{ form.password1.errors }}
    </div>
    <div>
        {{ form.password2.label_tag }}
        {{ form.password2 }}
        {{ form.password2.errors }}
    </div>
    <div>
        {{ form.user_type.label_tag }}
        {{ form.user_type }}
        {{ form.user_type.errors }}
    </div>
    <div id="curso_semestre_fields" style="display: none;">
        <div>
            {{ form.curso.label_tag }}
            {{ form.curso }}
            {{ form.curso.errors }}
        </div>
        <div>
            {{ form.semestre.label_tag }}
            {{ form.semestre }}
            {{ form.semestre.errors }}
        </div>
    </div>
    <div id="departamento_field" style="display: none;">
        <div>
            {{ form.departamento.label_tag }}
            {{ form.departamento }}
            {{ form.departamento.errors }}
        </div>
    </div>
    <div>
        {{ form.foto.label_tag }}
        {{ form.foto }}
        {{ form.foto.errors }}
    </div>
    <button type="submit">Cadastrar</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var userTypeSelect = document.getElementById('id_user_type');
    var cursoSemestreFields = document.getElementById('curso_semestre_fields');
    var departamentoField = document.getElementById('departamento_field');

    function toggleFields() {
        var selectedType = userTypeSelect.value;
        if (selectedType === 'aluno' || selectedType === 'representante') {
            cursoSemestreFields.style.display = 'block';
            departamentoField.style.display = 'none';
        } else if (selectedType === 'professor') {
            cursoSemestreFields.style.display = 'none';
            departamentoField.style.display = 'block';
        } else {
            cursoSemestreFields.style.display = 'none';
            departamentoField.style.display = 'none';
        }
    }

    userTypeSelect.addEventListener('change', toggleFields);
    toggleFields();  // Call once to set initial state
});
</script>

<p>Já tem uma conta? <a href="{% url 'login' %}">Faça login</a></p>
{% endblock %}