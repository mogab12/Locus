{% extends 'core/base.html' %}

{% block title %}Detalhes do Tópico - {{ topico.titulo }}{% endblock %}

{% block content %}
<h1>{{ topico.titulo }}</h1>
<p><strong>Descrição:</strong> {{ topico.descricao }}</p>
<p><strong>Criado por:</strong> {{ topico.criado_por.username }}
    <a href="{% url 'view_profile' topico.criado_por.id %}" class="btn btn-secondary">Ver Perfil</a>
</p>
<p><strong>Data de Criação:</strong> {{ topico.data_criacao }}</p>

{% if request.user.user_type == 'representante' or request.user.user_type == 'professor' %}
    <a href="{% url 'editar_topico' topico.id %}">Editar Tópico</a>
    <a href="{% url 'remover_topico' topico.id %}">Remover Tópico</a>
{% endif %}

<h2>Postagens</h2>
<ul>
  {% for postagem in topico.postagens.all %}
  <li>
    <p>{{ postagem.conteudo }}</p>
    <p><strong>Por:</strong> {{ postagem.criado_por.username }}
        <a href="{% url 'view_profile' postagem.criado_por.id %}" class="btn btn-secondary">Ver Perfil</a>
    </p>
    <p><strong>Data de Criação:</strong> {{ postagem.data_criacao }}</p>

    {% if request.user.user_type == 'representante' or request.user.user_type == 'professor' %}
        <a href="{% url 'remover_postagem' postagem.id %}">Remover Postagem</a>
    {% endif %}
  </li>
  {% empty %}
  <li>Não há postagens neste tópico ainda.</li>
  {% endfor %}
</ul>

{% if user.is_authenticated %}
    <h3>Adicionar nova postagem</h3>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Postar</button>
    </form>
{% endif %}

<a href="{% url 'lista_topicos' topico.disciplina.id %}">Voltar para Tópicos</a>
{% endblock %}